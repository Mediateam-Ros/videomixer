<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Countdown</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: black;
        }

        #countdown {
            font-size: 60px;
            color: white;
            position: fixed;
            top: 67%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body>
    <div id="countdown">LÃ¤dt...</div>

    <script>
        async function loadGameData() {
            try {
                // Lade die Daten aus der TXT-Datei
                const response = await fetch('http://localhost/anzeige/pregame.php');
                const data = await response.json();
                startCountdown(data);
            } catch (error) {
                console.error('Fehler beim Laden der Daten:', error);
                document.getElementById('countdown').innerText = 'Fehler beim Laden der Spieldaten.';
            }
        }

        function startCountdown(data) {
            const gameDate = new Date(data.todayGame.date);
            const [hours, minutes] = data.todayGame.time.split(':').map(Number);
            gameDate.setHours(hours, minutes, 0);

            // Deklariere die Variable "interval" hier
            let interval;

            function updateCountdown() {
                const now = new Date();
                const timeDifference = gameDate - now;
                if (timeDifference <= 0) {
                    clearInterval(countdownInterval);
                    return;
                }
                const hoursRemaining = Math.floor((timeDifference % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutesRemaining = Math.floor((timeDifference % (1000 * 60 * 60)) / (1000 * 60));
                const secondsRemaining = Math.floor((timeDifference % (1000 * 60)) / 1000);
                document.getElementById('countdown').innerText = `${hoursRemaining.toString().padStart(2, '0')}:${minutesRemaining.toString().padStart(2, '0')}:${secondsRemaining.toString().padStart(2, '0')}`;
            }

            updateCountdown();
            interval = setInterval(updateCountdown, 1000); // "interval" wird initialisiert
        }

        // Daten laden und Countdown starten
        loadGameData();
    </script>
</body>

</html>